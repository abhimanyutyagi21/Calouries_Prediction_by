<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FitTrack AI — Single Page App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --teal: #00A896;
      --charcoal: #1B1B1B;
      --card-bg: #f8fafc; /* light card background */
      --glass: rgba(255,255,255,0.6);
    }

    /* Global animations */
    .transition-fast { transition: all 220ms cubic-bezier(.2,.9,.3,1); }
    .transition-smooth { transition: all 420ms cubic-bezier(.2,.9,.3,1); }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(14px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeOutDown { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(10px); } }
    @keyframes floatSlow { 0%{ transform: translateY(0);}50%{ transform: translateY(-8px);}100%{ transform: translateY(0);} }

    .anim-in { animation: fadeInUp 420ms cubic-bezier(.2,.9,.3,1) both; }
    .anim-out { animation: fadeOutDown 300ms cubic-bezier(.2,.9,.3,1) both; }

    /* Card hover lift */
    .card-hover { transform: translateY(0); }
    .card-hover:hover { transform: translateY(-8px) scale(1.01); box-shadow: 0 20px 40px rgba(11, 22, 22, 0.08); }

    /* Button micro-interactions */
    .btn-teal { background: var(--teal); color: white; }
    .btn-teal:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,168,150,0.18); }
    .btn-ghost:hover { background: rgba(27,27,27,0.04); }

    /* Input focus glow */
    input:focus, select:focus { outline: none; box-shadow: 0 6px 20px rgba(0,168,150,0.08); border-color: rgba(0,168,150,0.45); }

    /* Navbar underline */
    .nav-link { position: relative; }
    .nav-link::after { content: ''; position: absolute; left: 50%; transform: translateX(-50%) scaleX(0); bottom: -6px; width: 60%; height: 3px; background: var(--teal); border-radius: 8px; transition: transform 220ms ease; }
    .nav-link.font-semibold::after { transform: translateX(-50%) scaleX(1); }

    /* Landing hero accent */
    .hero-accent { width: 220px; height: 220px; border-radius: 18px; background: linear-gradient(135deg, rgba(0,168,150,0.12), rgba(27,27,27,0.02)); display:flex; align-items:center; justify-content:center; }
    .hero-floating { animation: floatSlow 4s ease-in-out infinite; }

    /* Prediction result animation */
    .result-pop { transform-origin: center; animation: popIn 520ms cubic-bezier(.2,.9,.3,1) both; }
    @keyframes popIn { from { opacity: 0; transform: scale(0.92); } to { opacity: 1; transform: scale(1); } }

    /* Utility tweaks for mobile */
    @media (prefers-reduced-motion: reduce) { .anim-in, .anim-out, .hero-floating { animation: none !important; } }
  </style>
</head>
<body class="bg-white text-gray-800 antialiased selection:bg-[var(--teal)] selection:text-white">
  <!-- Fixed Header -->
  <header class="fixed top-0 left-0 right-0 bg-white/60 backdrop-blur z-40 border-b">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="font-extrabold text-xl flex items-center gap-2" style="color:var(--charcoal)">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center bg-[var(--teal)] text-white font-bold">FT</div>
          <div>FitTrack <span class="text-[var(--teal)]">AI</span></div>
        </div>
        <nav class="hidden md:flex gap-4 items-center text-sm">
          <a href="#" data-view="landing" class="nav-link px-3 py-2 rounded transition-fast">Home</a>
          <a href="#" data-view="calculator" class="nav-link px-3 py-2 rounded transition-fast">Calculator</a>
          <a href="#" data-view="predict" class="nav-link px-3 py-2 rounded transition-fast">Predict</a>
          <a href="#" data-view="login" class="nav-link px-3 py-2 rounded transition-fast">Login</a>
          <a href="#" data-view="signup" class="nav-link px-3 py-2 rounded transition-fast">Sign Up</a>
        </nav>
      </div>
      <div class="hidden md:flex items-center gap-3">
        <button data-view="login" class="px-4 py-2 rounded shadow-sm text-sm btn-teal transition-fast">Sign in</button>
      </div>
      <!-- mobile menu -->
      <div class="md:hidden">
        <button id="mobileMenuBtn" class="p-2 rounded border transition-fast">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
      </div>
    </div>
  </header>

  <main class="pt-24 max-w-6xl mx-auto px-4 pb-20">
    <!-- Landing View -->
    <section id="view-landing" class="view">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div class="space-y-6">
          <h1 class="text-4xl md:text-5xl font-extrabold leading-tight" style="color:var(--charcoal)">Track. Predict. <span class="text-[var(--teal)]">Improve.</span></h1>
          <p class="text-lg text-gray-600 max-w-xl">Use quick calculators, explore your metrics and get AI-assisted calorie estimates to power better workouts. Lightweight, private-first, and built for momentum.</p>

          <div class="mt-4 flex gap-4">
            <button data-view="predict" class="px-6 py-3 rounded shadow btn-teal transition-fast">Start Predicting</button>
            <button data-view="calculator" class="px-6 py-3 rounded shadow border btn-ghost transition-fast">Quick Calculator</button>
          </div>

          <div class="mt-6 grid grid-cols-3 gap-3 text-sm text-gray-600">
            <div class="p-4 bg-[var(--card-bg)] rounded-lg card-hover transition-fast">
              <div class="font-semibold">Personalized</div>
              <div class="text-xs">Metrics and progress</div>
            </div>
            <div class="p-4 bg-[var(--card-bg)] rounded-lg card-hover transition-fast">
              <div class="font-semibold">AI Estimates</div>
              <div class="text-xs">Quick session predictions</div>
            </div>
            <div class="p-4 bg-[var(--card-bg)] rounded-lg card-hover transition-fast">
              <div class="font-semibold">Motivation</div>
              <div class="text-xs">Set goals and track wins</div>
            </div>
          </div>
        </div>

        <div class="p-6 glass rounded-2xl shadow-lg hero-floating">
          <div class="flex items-start gap-4">
            <div class="hero-accent mr-3">
              <svg width="96" height="96" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2v20M2 12h20" stroke="#00A896" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.9"/></svg>
            </div>
            <div class="flex-1">
              <div class="text-sm text-gray-700 font-semibold mb-2">Sign up to save predictions</div>
              <form id="heroSignup" class="space-y-3">
                <div class="flex gap-2">
                  <input placeholder="Name" class="flex-1 p-3 rounded border transition-fast" required />
                </div>
                <div class="flex gap-2">
                  <input placeholder="Email" type="email" class="flex-1 p-3 rounded border transition-fast" required />
                </div>
                <div class="flex items-center gap-2">
                  <input placeholder="Password" type="password" class="flex-1 p-3 rounded border transition-fast" required />
                  <button type="button" data-view="signup" class="px-4 py-2 rounded btn-teal">Sign Up</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Login View -->
    <section id="view-login" class="view hidden">
      <div class="min-h-[60vh] flex items-center justify-center">
        <div class="w-full max-w-md bg-[var(--card-bg)] p-6 rounded-2xl shadow card-hover anim-in">
          <h2 class="text-2xl font-bold mb-4" style="color:var(--charcoal)">Welcome back</h2>
          <form id="formLogin" class="space-y-4">
            <input id="loginEmail" type="email" placeholder="Email" class="w-full p-3 rounded border transition-fast" required />
            <input id="loginPass" type="password" placeholder="Password" class="w-full p-3 rounded border transition-fast" required />
            <button type="submit" class="w-full py-3 rounded text-white btn-teal transition-fast">Log In</button>
          </form>
          <div class="mt-4 text-sm text-gray-600">Don't have an account? <a href="#" data-view="signup" class="text-[var(--teal)]">Sign up</a></div>
        </div>
      </div>
    </section>

    <!-- Sign Up View -->
    <section id="view-signup" class="view hidden">
      <div class="min-h-[60vh] flex items-center justify-center">
        <div class="w-full max-w-md bg-[var(--card-bg)] p-6 rounded-2xl shadow card-hover anim-in">
          <h2 class="text-2xl font-bold mb-4" style="color:var(--charcoal)">Create account</h2>
          <form id="formSignup" class="space-y-4">
            <input id="signupName" placeholder="Full name" class="w-full p-3 rounded border transition-fast" required />
            <input id="signupEmail" type="email" placeholder="Email" class="w-full p-3 rounded border transition-fast" required />
            <input id="signupPass" type="password" placeholder="Password" class="w-full p-3 rounded border transition-fast" required />
            <input id="signupPass2" type="password" placeholder="Confirm password" class="w-full p-3 rounded border transition-fast" required />
            <button type="submit" class="w-full py-3 rounded text-white btn-teal transition-fast">Sign Up</button>
          </form>
          <div class="mt-4 text-sm text-gray-600">Already have an account? <a href="#" data-view="login" class="text-[var(--teal)]">Log in</a></div>
        </div>
      </div>
    </section>

    <!-- Calculator View -->
    <section id="view-calculator" class="view hidden">
      <div class="py-6">
        <h2 class="text-2xl font-bold mb-4" style="color:var(--charcoal)">Quick Health Metrics</h2>
        <div class="grid md:grid-cols-2 gap-6">
          <!-- BMI Card -->
          <div class="bg-[var(--card-bg)] p-6 rounded-2xl shadow card-hover anim-in">
            <h3 class="font-semibold mb-3">BMI Calculator</h3>
            <div class="space-y-3">
              <div class="flex gap-2">
                <input id="bmiHeight" type="number" step="0.01" min="0" placeholder="Height (m)" class="w-1/2 p-3 rounded border transition-fast" />
                <input id="bmiWeight" type="number" step="0.1" min="0" placeholder="Weight (kg)" class="w-1/2 p-3 rounded border transition-fast" />
              </div>
              <button id="calcBmiBtn" class="px-4 py-2 rounded btn-teal transition-fast">Calculate BMI</button>
              <div id="bmiResult" class="mt-3 p-3 rounded bg-white border shadow-sm">BMI: — <br/>Category: —</div>
            </div>
          </div>

          <!-- Lean Mass Card -->
          <div class="bg-[var(--card-bg)] p-6 rounded-2xl shadow card-hover anim-in">
            <h3 class="font-semibold mb-3">Lean Mass Estimate</h3>
            <div class="space-y-3">
              <select id="lmGender" class="w-full p-3 rounded border transition-fast">
                <option value="male">Male</option>
                <option value="female">Female</option>
              </select>
              <div class="flex gap-2">
                <input id="lmHeight" type="number" step="0.1" min="0" placeholder="Height (cm)" class="w-1/2 p-3 rounded border transition-fast" />
                <input id="lmWeight" type="number" step="0.1" min="0" placeholder="Weight (kg)" class="w-1/2 p-3 rounded border transition-fast" />
              </div>
              <input id="lmFat" type="number" step="0.1" min="0" max="100" placeholder="Fat Percentage (%)" class="w-full p-3 rounded border transition-fast" />
              <button id="calcLmBtn" class="px-4 py-2 rounded btn-teal transition-fast">Estimate Lean Mass</button>
              <div id="lmResult" class="mt-3 p-3 rounded bg-white border shadow-sm">Lean Mass: — kg</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Predict View -->
    <section id="view-predict" class="view hidden">
      <div class="py-6">
        <h2 class="text-2xl font-bold mb-4" style="color:var(--charcoal)">AI Calories Burned Predictor</h2>
        <form id="predictForm" class="space-y-6 bg-[var(--card-bg)] p-6 rounded-2xl shadow card-hover anim-in">
          <!-- A. Personal Metrics -->
          <div class="grid md:grid-cols-4 gap-3">
            <div>
              <label class="text-xs font-medium">Age</label>
              <input id="age" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
            </div>
            <div>
              <label class="text-xs font-medium">Gender</label>
              <select id="gender" class="w-full p-3 rounded border transition-fast">
                <option>Male</option>
                <option>Female</option>
                <option>Other</option>
              </select>
            </div>
            <div>
              <label class="text-xs font-medium">Weight (kg)</label>
              <input id="weight" type="number" step="0.1" min="0" class="w-full p-3 rounded border transition-fast" />
            </div>
            <div>
              <label class="text-xs font-medium">Height (m)</label>
              <input id="height" type="number" step="0.01" min="0" class="w-full p-3 rounded border transition-fast" />
            </div>
            <div>
              <label class="text-xs font-medium">Fat %</label>
              <input id="fat_percentage" type="number" step="0.1" min="0" max="100" class="w-full p-3 rounded border transition-fast" />
            </div>
            <div>
              <label class="text-xs font-medium">BMI</label>
              <input id="bmi_input" type="number" step="0.01" min="0" class="w-full p-3 rounded border transition-fast" />
            </div>
          </div>

          <!-- B. Workout Session Details -->
          <div>
            <h3 class="font-semibold mb-3">Workout Session Details</h3>
            <div class="grid md:grid-cols-4 gap-3">
              <div>
                <label class="text-xs font-medium">Workout Type</label>
                <select id="workout_type" class="w-full p-3 rounded border transition-fast">
                  <option>Strength</option>
                  <option>Cardio</option>
                  <option>Flexibility</option>
                  <option>Other</option>
                </select>
              </div>
              <div>
                <label class="text-xs font-medium">Session Duration (hours)</label>
                <input id="session_duration" type="number" step="0.01" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Workout Frequency (days/week)</label>
                <input id="workout_freq" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Max BPM</label>
                <input id="max_bpm" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Avg BPM</label>
                <input id="avg_bpm" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Resting BPM</label>
                <input id="resting_bpm" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Difficulty</label>
                <select id="difficulty" class="w-full p-3 rounded border transition-fast">
                  <option>Beginner</option>
                  <option>Intermediate</option>
                  <option>Advanced</option>
                </select>
              </div>
              <div>
                <label class="text-xs font-medium">Body Part</label>
                <select id="body_part" class="w-full p-3 rounded border transition-fast">
                  <option>Core</option>
                  <option>Upper Body</option>
                  <option>Lower Body</option>
                  <option>Full Body</option>
                  <option>Other</option>
                </select>
              </div>
            </div>
          </div>

          <!-- C. Nutrition & Food Intake -->
          <div>
            <h3 class="font-semibold mb-3">Nutrition & Food Intake</h3>
            <div class="grid md:grid-cols-4 gap-3">
              <div>
                <label class="text-xs font-medium">Meal Type</label>
                <select id="meal_type" class="w-full p-3 rounded border transition-fast">
                  <option>Breakfast</option>
                  <option>Lunch</option>
                  <option>Dinner</option>
                  <option>Snack</option>
                </select>
              </div>
              <div>
                <label class="text-xs font-medium">Diet Type</label>
                <select id="diet_type" class="w-full p-3 rounded border transition-fast">
                  <option>Standard</option>
                  <option>Vegan</option>
                  <option>Keto</option>
                  <option>Paleo</option>
                  <option>Mediterranean</option>
                </select>
              </div>
              <div>
                <label class="text-xs font-medium">Cooking Method</label>
                <select id="cooking_method" class="w-full p-3 rounded border transition-fast">
                  <option>Baked</option>
                  <option>Boiled</option>
                  <option>Grilled</option>
                  <option>Fried</option>
                  <option>Steamed</option>
                </select>
              </div>
              <div>
                <label class="text-xs font-medium">Water Intake (L)</label>
                <input id="water_intake" type="number" step="0.1" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>

              <div>
                <label class="text-xs font-medium">Daily meals frequency</label>
                <input id="meals_freq" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Sugar (g)</label>
                <input id="sugar_g" type="number" step="0.1" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Sodium (mg)</label>
                <input id="sodium_mg" type="number" step="1" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Cholesterol (mg)</label>
                <input id="cholesterol_mg" type="number" step="1" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>

              <div>
                <label class="text-xs font-medium">Serving size (g)</label>
                <input id="serving_size_g" type="number" step="1" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Prep time (min)</label>
                <input id="prep_time_min" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Cook time (min)</label>
                <input id="cook_time_min" type="number" min="0" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Rating (1.0 - 5.0)</label>
                <input id="rating" type="number" step="0.1" min="1" max="5" class="w-full p-3 rounded border transition-fast" />
              </div>
            </div>
          </div>

          <!-- D. Lifestyle & Experience -->
          <div>
            <h3 class="font-semibold mb-3">Lifestyle & Experience</h3>
            <div class="grid md:grid-cols-3 gap-3">
              <div>
                <label class="text-xs font-medium">Experience Level (1-5)</label>
                <input id="experience" type="number" min="1" max="5" step="1" class="w-full p-3 rounded border transition-fast" />
              </div>
              <div>
                <label class="text-xs font-medium">Physical exercise (0: None, 1: Yes)</label>
                <input id="physical_exercise" type="number" min="0" max="1" class="w-full p-3 rounded border transition-fast" />
              </div>
            </div>
          </div>

          <div>
            <button id="predictBtn" type="button" class="w-full py-4 rounded text-white btn-teal text-lg font-semibold transition-fast">Predict Calories</button>
          </div>

          <div id="predictionResult" class="mt-4 p-6 text-center rounded-xl bg-white border shadow-lg text-xl font-bold">Predicted Calories: —</div>
        </form>
      </div>
    </section>

  </main>

  <footer class="max-w-6xl mx-auto px-4 py-8 text-sm text-gray-500">
    Built with ❤️ · FitTrack AI
  </footer>

  <script>
    // View switching with smooth transitions
    const views = document.querySelectorAll('.view');
    let currentView = document.querySelector('.view:not(.hidden)') || document.getElementById('view-landing');

    function showView(name){
      const next = document.getElementById('view-' + name);
      if(!next) return;
      if(next === currentView) return;

      // animate out current
      if(currentView){
        currentView.classList.add('anim-out');
        currentView.classList.remove('anim-in');
      }

      // after out animation, hide it and show next
      setTimeout(()=>{
        if(currentView) currentView.classList.add('hidden');
        // show next
        next.classList.remove('hidden');
        next.classList.remove('anim-out');
        next.classList.add('anim-in');
        currentView = next;
        // update nav styles
        document.querySelectorAll('.nav-link').forEach(a=>a.classList.remove('font-semibold'));
        document.querySelectorAll('[data-view="'+name+'"').forEach(el=>el.classList.add('font-semibold'));
        window.scrollTo({top:0,behavior:'smooth'});
      }, 260);
    }

    document.querySelectorAll('[data-view]').forEach(btn=>btn.addEventListener('click', e=>{ e.preventDefault(); showView(btn.dataset.view); }));
    // default
    showView('landing');

    // mobile menu toggle
    const mobileBtn = document.getElementById('mobileMenuBtn');
    mobileBtn?.addEventListener('click', ()=>{
      const menu = document.createElement('div');
      menu.className = 'fixed inset-0 bg-black/30 z-50 flex';
      const inner = document.createElement('div');
      inner.className = 'p-6 bg-white w-72 h-full shadow-lg';
      inner.innerHTML = `
        <div class="font-bold text-lg mb-4">FitTrack AI</div>
        <div class="flex flex-col gap-3">
          <a href="#" data-view="landing" class="p-3 rounded">Home</a>
          <a href="#" data-view="calculator" class="p-3 rounded">Calculator</a>
          <a href="#" data-view="predict" class="p-3 rounded">Predict</a>
          <a href="#" data-view="login" class="p-3 rounded">Login</a>
          <a href="#" data-view="signup" class="p-3 rounded">Sign Up</a>
        </div>
      `;
      menu.appendChild(inner);
      document.body.appendChild(menu);
      menu.addEventListener('click', ()=> menu.remove());
      inner.querySelectorAll('[data-view]').forEach(el=>el.addEventListener('click', (ev)=>{ ev.preventDefault(); showView(el.dataset.view); menu.remove(); }));
    });

    // --- calculators & logic (preserve original behavior) ---
    function bmiCategory(bmi){
      if(bmi <= 0) return '—';
      if(bmi < 18.5) return 'Underweight';
      if(bmi < 25) return 'Normal weight';
      if(bmi < 30) return 'Overweight';
      return 'Obesity';
    }
    document.getElementById('calcBmiBtn').addEventListener('click', ()=>{
      const h = parseFloat(document.getElementById('bmiHeight').value)||0;
      const w = parseFloat(document.getElementById('bmiWeight').value)||0;
      const res = document.getElementById('bmiResult');
      if(h <= 0 || w <= 0){ res.innerHTML = 'Please enter valid height and weight.'; return; }
      const bmi = w / (h*h);
      res.innerHTML = `BMI: ${bmi.toFixed(2)} <br/>Category: ${bmiCategory(bmi)}`;
      // subtle result animation
      res.classList.add('result-pop'); setTimeout(()=>res.classList.remove('result-pop'),600);
      // autofill BMI in predictor
      document.getElementById('bmi_input').value = bmi.toFixed(2);
    });

    document.getElementById('calcLmBtn').addEventListener('click', ()=>{
      const weight = parseFloat(document.getElementById('lmWeight').value)||0;
      const fat = parseFloat(document.getElementById('lmFat').value)||0;
      const res = document.getElementById('lmResult');
      if(weight <= 0 || fat < 0){ res.innerHTML = 'Please enter valid weight and fat percentage.'; return; }
      const lean = weight * (1 - (fat/100));
      res.innerHTML = `Lean Mass: ${lean.toFixed(2)} kg`;
      res.classList.add('result-pop'); setTimeout(()=>res.classList.remove('result-pop'),600);
    });

    // Predict calories — placeholder heuristic using METs with animation
    document.getElementById('predictBtn').addEventListener('click', ()=>{
      const btn = document.getElementById('predictBtn');
      btn.disabled = true; btn.classList.add('opacity-70');

      setTimeout(()=>{
        const weight = parseFloat(document.getElementById('weight').value) || 70;
        const duration = parseFloat(document.getElementById('session_duration').value) || 0.5; // hours
        const type = document.getElementById('workout_type').value;
        const difficulty = document.getElementById('difficulty').value;

        const metMap = { 'Cardio':8, 'Strength':6, 'Flexibility':3, 'Other':4 };
        let met = metMap[type] || 5;
        if(difficulty === 'Beginner') met *= 0.9;
        if(difficulty === 'Intermediate') met *= 1.0;
        if(difficulty === 'Advanced') met *= 1.15;
        let calories = met * weight * duration;
        const avg_bpm = parseFloat(document.getElementById('avg_bpm').value) || 0;
        const resting = parseFloat(document.getElementById('resting_bpm').value) || 0;
        if(avg_bpm > resting + 10) calories *= 1 + Math.min((avg_bpm - resting)/200, 0.2);
        const rating = parseFloat(document.getElementById('rating').value) || 3;
        calories *= 1 + ((rating - 3) * 0.02);
        const freq = parseFloat(document.getElementById('workout_freq').value) || 2;
        const exp = parseFloat(document.getElementById('experience').value) || 3;
        calories *= 1 + ((4 - exp) * 0.01) * Math.max(0, 3 - freq);
        calories = Math.max(0, Math.round(calories));

        const out = document.getElementById('predictionResult');
        // animated count up
        animateNumber(out, 0, calories, 700, (n)=>{ out.innerText = `Predicted Calories: ${n.toLocaleString()}`; });
        out.classList.add('result-pop'); setTimeout(()=>out.classList.remove('result-pop'),800);
        btn.disabled = false; btn.classList.remove('opacity-70');
      }, 450);
    });

    // Simple auth form handlers (mock)
    document.getElementById('formLogin').addEventListener('submit', (e)=>{ e.preventDefault(); alert('Logged in (mock).'); showView('predict'); });
    document.getElementById('formSignup').addEventListener('submit', (e)=>{ e.preventDefault(); alert('Account created (mock).'); showView('predict'); });
    document.getElementById('heroSignup')?.addEventListener('submit', (e)=>{ e.preventDefault(); alert('Thanks! (mock)'); showView('predict'); });

    // helper: animate numeric counter inside element
    function animateNumber(el, start, end, duration, onUpdate){
      const startTime = performance.now();
      function step(now){
        const t = Math.min(1, (now - startTime) / duration);
        const eased = t<0.5 ? 2*t*t : -1 + (4 - 2*t)*t; // easeInOutQuad-like
        const value = Math.round(start + (end - start) * eased);
        onUpdate(value);
        if(t < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }
  </script>
</body>
</html>
